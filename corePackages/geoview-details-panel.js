/*! Package:geoview-details-panel: 0.1.0 - "93cfafb4f2f017f356f2280aee39365ac03c7275" - 2023-05-25T15:45:38.799Z */
"use strict";(self.webpackChunkgeoview_core=self.webpackChunkgeoview_core||[]).push([[138],{46414:(e,t,n)=>{var a=n(11265),i=n(15288),o=n(90187),r=n(57667),s=n(84772),u=n(24518),l=n(18148),c=n(32906),p=n(80656),f=n(46393),d=n(45202),m=window;function h(e){var t,n=e.mapId,a=e.buttonId,i=m.cgpv.api,o=(0,f.useState)([]),r=(0,p.Z)(o,2),s=r[0],u=r[1],l=(0,f.useState)(),h=(0,p.Z)(l,2),v=h[0],g=h[1],y=(0,f.useState)([]),_=(0,p.Z)(y,2),E=_[0],I=_[1],P=(0,f.useState)(null),N=(0,p.Z)(P,2),Z=N[0],b=N[1],S=null===(t=i.map(n).appBarButtons.getAppBarButtonPanelById(void 0===a?"":a))||void 0===t?void 0:t.panel;return(0,f.useEffect)((function(){return i.event.on(i.eventNames.GET_FEATURE_INFO.ALL_QUERIES_DONE,(function(e){if((0,c.gNW)(e)){var t=e.resultSets,a=[];Object.keys(t).forEach((function(e){var o=(0,c.dIw)(i.map(n).layer.registeredLayers[e].layerName,n),r=t[e];r.length>0&&a.push({layerPath:e,layerName:o,features:r})})),a.length>0?(u(a),null==S||S.open()):u([])}else u([])}),"".concat(n,"/$FeatureInfoLayerSet$")),i.event.on(i.eventNames.MAP.EVENT_MAP_SINGLE_CLICK,(function(e){if((0,c.yp4)(e)){var t=e.coordinates;b(e.handlerName),I(t.lnglat)}else I([])}),n),function(){i.event.off(i.eventNames.GET_FEATURE_INFO.ALL_QUERIES_DONE,n),i.event.off(i.eventNames.MAP.EVENT_MAP_SINGLE_CLICK,n)}}),[]),(0,f.useEffect)((function(){g(i.map(n).details.createDetails(n,s,{mapId:n,location:E,backgroundStyle:"dark",singleColumn:!0,handlerName:Z})),setTimeout((function(){i.event.emit((0,c.usG)(i.eventNames.MARKER_ICON.EVENT_MARKER_ICON_SHOW,Z,E))}),800)}),[s,E]),(0,d.jsx)("div",{children:v})}const v=JSON.parse('{"$schema":"http://json-schema.org/draft-07/schema#","title":"GeoView Details Panel/Legend Config Schema","type":"object","version":1,"comments":"Configuration for GeoView layers package.","additionalProperties":false,"properties":{"suportedLanguages":{"type":"array","uniqueItems":true,"items":{"type":"string","enum":["en","fr"]},"default":["en","fr"],"description":"ISO 639-1 code indicating the languages supported by the configuration file.","minItems":1},"version":{"type":"string","enum":["1.0"],"description":"The schema version used to validate the configuration file. The schema should enumerate the list of versions accepted by this version of the viewer."}},"required":["suportedLanguages"]}'),g=JSON.parse('{"suportedLanguages":["en","fr"]}');function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,u.Z)(e);if(t){var i=(0,u.Z)(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return(0,s.Z)(this,n)}}var _=window,E=function(e){(0,r.Z)(n,e);var t=y(n);function n(e,i){var r;return(0,a.Z)(this,n),r=t.call(this,e,i),(0,l.Z)((0,o.Z)(r),"schema",(function(){return v})),(0,l.Z)((0,o.Z)(r),"defaultConfig",(function(){return(0,c.ZQJ)(g)})),(0,l.Z)((0,o.Z)(r),"translations",(0,c.ZQJ)({en:{detailsPanel:"Details",nothing_found:"Nothing found",click_map:"Choose a point on the map to start",action_back:"Back"},fr:{detailsPanel:"Détails",nothing_found:"Aucun résultat",click_map:"Choisissez un point sur la carte pour commencer",action_back:"Retour"}})),(0,l.Z)((0,o.Z)(r),"added",(function(){var e,t,n=r.pluginProps.mapId,a=_.cgpv,i=a.api,o=a.ui.elements.DetailsIcon,s=i.map(n).displayLanguage,u={id:"detailsPanelButton",tooltip:r.translations[s].detailsPanel,tooltipPlacement:"right",children:(0,d.jsx)(o,{}),visible:!0},l={title:r.translations[s].detailsPanel,icon:'<i class="material-icons">details</i>',width:350};r.buttonPanel=i.map(n).appBarButtons.createAppbarPanel(u,l,null),null===(e=r.buttonPanel)||void 0===e||null===(t=e.panel)||void 0===t||t.changeContent((0,d.jsx)(h,{mapId:n,buttonId:u.id}))})),r.buttonPanel=null,r}return(0,i.Z)(n,[{key:"removed",value:function(){var e=this.pluginProps.mapId,t=_.cgpv.api;this.buttonPanel&&t.map(e).appBarButtons.removeAppbarPanel(this.buttonPanel.buttonPanelId)}}]),n}(c.Vw$);_.plugins=_.plugins||{},_.plugins["details-panel"]=(0,c.RFZ)(E)}},e=>{var t;t=46414,e(e.s=t)}]);
//# sourceMappingURL=geoview-details-panel.js.map