/*! Package:geoview-time-slider: 2.0.2 - "efe111a057f077eb7eff824ebc617c99446436e1" - 2025-09-19T15:20:58.864Z */
"use strict";(self.webpackChunkgeoview_core=self.webpackChunkgeoview_core||[]).push([[405],{15838:(e,t,i)=>{i.a(e,async(e,n)=>{try{i.d(t,{p:()=>x});var r=i(10379),a=i(6416),l=i(67927),o=i(32267),s=i(36255),c=i(63703),d=i(68604),u=i(59721),p=i(450),f=i(84883),g=i(47246),m=i(97282),h=e([l,o,s,c,d,u]);function v(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)}return i}function y(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?v(Object(i),!0).forEach(function(t){(0,r.A)(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):v(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}function x(e){var t;p.vF.logTraceRender("geoview-time-slider/time-slider",e);var i=window.cgpv,n=e.config,r=e.layerPath,h=i.reactUtilities,v=i.ui,x=v.useTheme,P=h.react,L=P.useState,j=P.useRef,w=P.useEffect,b=P.useCallback,S=v.elements,k=S.Grid,T=S.Slider,M=S.Typography,A=S.Checkbox,D=S.Tooltip,I=S.IconButton,E=S.LockIcon,C=S.LockOpenIcon,V=S.ArrowLeftIcon,z=S.PlayArrowIcon,O=S.PauseIcon,F=S.ArrowRightIcon,R=S.SwitchRightIcon,B=S.SwitchLeftIcon,N=S.FormControl,U=S.InputLabel,G=S.NativeSelect,H=x(),Y=(0,g.S)(H),W=L(!1),q=(0,a.A)(W,2),J=q[0],K=q[1],_=j(),Z=j(),$=j(),Q=(0,o.Gg)(),X=Q.setTitle,ee=Q.setDefaultValue,te=Q.setDescription,ie=Q.setValues,ne=Q.setLocked,re=Q.setReversed,ae=Q.setDelay,le=Q.setStep,oe=Q.setFiltering,se=(0,u.t)(),ce=(0,o.ky)()[r],de=ce.title,ue=ce.description,pe=ce.defaultValue,fe=ce.discreteValues,ge=ce.step,me=ce.range,he=ce.minAndMax,ve=ce.filtering,ye=ce.singleHandle,xe=ce.values,Pe=ce.delay,Le=ce.locked,je=ce.reversed,we=ce.displayPattern,be=(0,s.Yo)(),Se=null===(t=c.K.findLayerByPath(be,r))||void 0===t?void 0:t.layerName,ke=me.map(function(e){return"number"!=typeof e?f.P.convertToMilliseconds(e):e}),Te=[];if(me.length<4&&fe){var Me=(f.P.convertToMilliseconds(me[me.length-1])-f.P.convertToMilliseconds(me[0]))/4;Te=[he[0],he[0]+Me,he[0]+2*Me,he[0]+3*Me,he[1]]}else Te=me.length<6||ye?ke:[he[0],f.P.convertToMilliseconds(me[Math.round(me.length/4)]),f.P.convertToMilliseconds(me[Math.round(me.length/2)]),f.P.convertToMilliseconds(me[Math.round(3*me.length/4)]),he[1]];for(var Ae=[],De=0;De<Te.length;De++)Ae.push({value:Te[De],label:void 0!==we[1]?f.P.formatDatePattern(Te[De],void 0,we[1]):f.P.formatDatePattern(Te[De],we[0],we[1])});var Ie=b(function(e){var t="forward"===e,i=t?1:-1;if(!ye||fe)if(ye){var n=ge||(he[1]-he[0])/20,l=xe[0]+n*i;ie(r,[l>he[1]?he[0]:l<he[0]?he[1]:l])}else{var o=(0,a.A)(xe,2),s=o[0],c=o[1];if(c-s===he[1]-he[0])return $.current=(he[1]-he[0])/10,void ie(r,t?[s,s+$.current]:[c-$.current,c]);$.current||($.current=c-s);var d=$.current*i;if(Le&&je){if(s+=d,t&&s>=c||!t&&s<he[0])s=(0,a.A)(he,1)[0]}else if(Le){if(t&&c===he[1]&&(c=s),(c+=d)>he[1])c=(0,a.A)(he,2)[1];else!t&&c<s&&(c=s);if(!t&&c===s)c=(0,a.A)(he,2)[1]}else if(t){if(s<Z.current&&c===Z.current?s=Z.current:s+=d,s>=he[1])s=(0,a.A)(he,1)[0];if((c=s+$.current)>he[1])c=(0,a.A)(he,2)[1];c>Z.current&&s<Z.current&&(c=Z.current)}else{if(c>Z.current&&s===Z.current?c=Z.current:c+=d,c<=he[0])c=(0,a.A)(he,2)[1];if((s=c-$.current)<he[0])s=(0,a.A)(he,1)[0];s<Z.current&&c>Z.current&&(s=Z.current)}ie(r,[s,c])}else{var u=ke.indexOf(xe[0]),p=u===(t?ke.length-1:0)?t?0:ke.length-1:u+i;ie(r,[ke[p]])}},[fe,r,Le,he,je,ie,ye,ge,ke,xe]),Ee=b(function(){Ie("back")},[Ie]),Ce=b(function(){Ie("forward")},[Ie]);w(function(){var e;p.vF.logTraceUseEffect("TIME-SLIDER - mount");var t=null==n||null===(e=n.sliders)||void 0===e?void 0:e.find(function(e){return e.layerPaths.includes(r)});void 0===de&&X(r,(null==t?void 0:t.title)||""),void 0===ue&&te(r,(null==t?void 0:t.description)||""),void 0===Le&&ne(r,void 0!==(null==t?void 0:t.locked)&&(null==t?void 0:t.locked)),void 0===je&&re(r,void 0!==(null==t?void 0:t.reversed)&&(null==t?void 0:t.reversed)),void 0===pe&&ee(r,(null==t?void 0:t.defaultValue)||"")},[]),w(function(){var e;p.vF.logTraceUseEffect("TIME-SLIDER - config layerPath",n,r);var t=null==n||null===(e=n.sliders)||void 0===e?void 0:e.find(function(e){return e.layerPaths.includes(r)});null!=t&&t.defaultValue&&(Array.isArray(null==t?void 0:t.defaultValue)?ie(r,[f.P.convertToMilliseconds(null==t?void 0:t.defaultValue[0]),f.P.convertToMilliseconds(null==t?void 0:t.defaultValue[1])]):me.includes(null==t?void 0:t.defaultValue)?ie(r,[f.P.convertToMilliseconds(null==t?void 0:t.defaultValue)]):ie(r,[f.P.convertToMilliseconds(me[0])]))},[n,r,me,oe,ie]),w(function(){p.vF.logTraceUseEffect("TIME-SLIDER - values filtering",xe,ve),J&&(_.current=je?window.setTimeout(Ee,Pe):window.setTimeout(Ce,Pe))},[xe,ve,je,Le]),w(function(){p.vF.logTraceUseEffect("TIME-SLIDER - isPlaying",J),J&&(je?Ee():Ce())},[J]);var Ve=b(function(){Z.current=je?xe[1]:xe[0],Ee()},[Ee,je,xe]),ze=b(function(){var e=(0,a.A)(xe,1);Z.current=e[0],Ce()},[Ce,xe]),Oe=b(function(){clearTimeout(_.current),ne(r,!Le)},[r,Le,ne]),Fe=b(function(){clearTimeout(_.current),Z.current=je?xe[1]:xe[0],K(!J)},[J,je,xe]),Re=b(function(){clearTimeout(_.current),re(r,!je),J&&(je?Ee():Ce())},[J,r,Ee,Ce,je,re]),Be=b(function(e){ae(r,Number(e.target.value))},[r,ae]),Ne=b(function(e){le(r,Number(e.target.value))},[r,le]),Ue=b(function(e,t){oe(r,t),t||(clearInterval(_.current),K(!1))},[r,oe]),Ge=b(function(e){p.vF.logTraceUseCallback("TIME-SLIDER - handleSliderChange",r),clearTimeout(_.current),K(!1),$.current=void 0,ie(r,e)},[r,ie]),He=b(function(e){return p.vF.logTraceUseCallback("TIME-SLIDER - handleLabelFormat",we),f.P.formatDatePattern(xe[0],we[0],we[1]),f.P.formatDatePattern(e,we[0],we[1])},[we,xe]);function Ye(){return je?Le?(0,d.getLocalizedMessage)(se,"timeSlider.slider.unlockRight"):(0,d.getLocalizedMessage)(se,"timeSlider.slider.lockRight"):Le?(0,d.getLocalizedMessage)(se,"timeSlider.slider.unlockLeft"):(0,d.getLocalizedMessage)(se,"timeSlider.slider.lockLeft")}return(0,m.jsx)(k,{children:(0,m.jsxs)(l.Box,{sx:{padding:"10px 10px"},children:[(0,m.jsxs)(k,{container:!0,sx:y(y({},Y.rightPanelBtnHolder),{},{flexWrap:"nowrap"}),children:[(0,m.jsx)(k,{size:{xs:9},children:(0,m.jsxs)(M,{component:"div",sx:y(y({},Y.panelHeaders),{},{paddingLeft:"20px",paddingTop:"10px"}),children:["".concat(de||Se),void 0===we[0]&&" (".concat(f.P.formatDate(pe,"YYYY-MM-DD"),")")]})}),(0,m.jsx)(k,{size:{xs:3},children:(0,m.jsx)(l.Box,{sx:{textAlign:"right",marginRight:"25px"},children:(0,m.jsx)(D,{title:ve?(0,d.getLocalizedMessage)(se,"timeSlider.slider.disableFilter"):(0,d.getLocalizedMessage)(se,"timeSlider.slider.enableFilter"),placement:"top",enterDelay:1e3,children:(0,m.jsx)(A,{checked:ve,onChange:Ue})})})})]}),(0,m.jsx)(k,{size:{xs:12},children:(0,m.jsx)(l.Box,{sx:{textAlign:"center",paddingTop:"20px"},children:(0,m.jsx)(T,{style:{width:"80%",color:"primary"},min:he[0],max:he[1],value:xe,marks:Ae,step:fe?ge||.1:null,onChangeCommitted:Ge,onValueLabelFormat:He},xe[1]?xe[1]+xe[0]:xe[0])})}),(0,m.jsx)(k,{size:{xs:12},children:(0,m.jsxs)(l.Box,{sx:{textAlign:"center",paddingTop:"20px"},children:[!ye&&(0,m.jsx)(I,{className:"buttonOutline","aria-label":Ye(),tooltip:Ye(),tooltipPlacement:"top",onClick:Oe,children:Le?(0,m.jsx)(E,{}):(0,m.jsx)(C,{})}),(0,m.jsx)(I,{className:"buttonOutline","aria-label":(0,d.getLocalizedMessage)(se,"timeSlider.slider.back"),tooltip:(0,d.getLocalizedMessage)(se,"timeSlider.slider.back"),tooltipPlacement:"top",disabled:J||!ve,onClick:Ve,children:(0,m.jsx)(V,{})}),(0,m.jsx)(I,{className:"buttonOutline","aria-label":J?(0,d.getLocalizedMessage)(se,"timeSlider.slider.pauseAnimation"):(0,d.getLocalizedMessage)(se,"timeSlider.slider.playAnimation"),tooltip:J?(0,d.getLocalizedMessage)(se,"timeSlider.slider.pauseAnimation"):(0,d.getLocalizedMessage)(se,"timeSlider.slider.playAnimation"),tooltipPlacement:"top",disabled:!ve,onClick:Fe,children:J?(0,m.jsx)(O,{}):(0,m.jsx)(z,{})}),(0,m.jsx)(I,{className:"buttonOutline","aria-label":(0,d.getLocalizedMessage)(se,"timeSlider.slider.forward"),tooltip:(0,d.getLocalizedMessage)(se,"timeSlider.slider.forward"),tooltipPlacement:"top",disabled:J||!ve,onClick:ze,children:(0,m.jsx)(F,{})}),(0,m.jsx)(I,{className:"buttonOutline","aria-label":(0,d.getLocalizedMessage)(se,"timeSlider.slider.changeDirection"),tooltip:(0,d.getLocalizedMessage)(se,"timeSlider.slider.changeDirection"),tooltipPlacement:"top",onClick:Re,children:je?(0,m.jsx)(R,{}):(0,m.jsx)(B,{})}),(0,m.jsx)(l.Box,{component:"span",sx:{paddingLeft:"10px"},children:(0,m.jsxs)(N,{sx:{width:"100px"},children:[(0,m.jsx)(U,{variant:"standard",children:(0,d.getLocalizedMessage)(se,"timeSlider.slider.timeDelay")}),(0,m.jsxs)(G,{defaultValue:Pe,inputProps:{name:"timeDelay",onChange:Be},children:[(0,m.jsx)("option",{value:500,children:"0.5s"}),(0,m.jsx)("option",{value:750,children:"0.75s"}),(0,m.jsx)("option",{value:1e3,children:"1.0s"}),(0,m.jsx)("option",{value:1500,children:"1.5s"}),(0,m.jsx)("option",{value:2e3,children:"2.0s"}),(0,m.jsx)("option",{value:3e3,children:"3.0s"}),(0,m.jsx)("option",{value:5e3,children:"5.0s"})]})]})}),ye&&fe&&(0,m.jsx)(l.Box,{component:"span",sx:{paddingLeft:"10px"},children:(0,m.jsxs)(N,{sx:{width:"100px"},children:[(0,m.jsx)(U,{variant:"standard",children:(0,d.getLocalizedMessage)(se,"timeSlider.slider.stepValue")}),(0,m.jsxs)(G,{defaultValue:ge,inputProps:{name:"timeStep",onChange:Ne},children:[(0,m.jsx)("option",{value:36e5,children:(0,d.getLocalizedMessage)(se,"timeSlider.slider.hour")}),(0,m.jsx)("option",{value:864e5,children:(0,d.getLocalizedMessage)(se,"timeSlider.slider.day")}),(0,m.jsx)("option",{value:6048e5,children:(0,d.getLocalizedMessage)(se,"timeSlider.slider.week")}),(0,m.jsx)("option",{value:2592e6,children:(0,d.getLocalizedMessage)(se,"timeSlider.slider.month")}),(0,m.jsx)("option",{value:31536e6,children:(0,d.getLocalizedMessage)(se,"timeSlider.slider.year")})]})]})})]})}),ue&&(0,m.jsx)(k,{size:{xs:12},children:(0,m.jsx)(M,{component:"div",sx:{px:"20px",py:"5px"},children:ue})})]})})}[l,o,s,c,d,u]=h.then?(await h)():h,n()}catch(P){n(P)}})},47246:(e,t,i)=>{i.d(t,{S:()=>n});var n=function(e){return{panelHeaders:{fontSize:e.palette.geoViewFontSize.lg,fontWeight:"600",marginBottom:"20px"},rightPanelBtnHolder:{marginTop:"20px",marginBottom:"9px",boxShadow:"0px 12px 9px -13px #E0E0E0"}}}},58938:e=>{e.exports={sliders:[]}},63755:(e,t,i)=>{i.a(e,async(e,n)=>{try{i.d(t,{b:()=>v});var r=i(6416),a=i(9785),l=i(32267),o=i(9820),s=i(36255),c=i(63703),d=i(67927),u=i(450),p=i(45902),f=i(84883),g=i(15838),m=i(97282),h=e([a,l,o,s,c,d,g]);function v(e){var t=e.mapId,i=e.configObj,n=window.cgpv.reactUtilities.react,h=n.useCallback,v=n.useMemo,y=n.useEffect,x=(0,o.wE)(),P=(0,l.ky)(),L=(0,l.h4)(),j=(0,l.Gg)().setSelectedLayerPath,w=(0,o.U6)().isLayerHiddenOnMap,b=(0,s.Yo)(),S=h(function(e){u.vF.logTraceUseCallback("TIME-SLIDER-PANEL - handleLayerList"),j(e.layerPath)},[j]),k=function(e){if(e.filtering){var t=e.values,i=(0,r.A)(e.displayPattern,2),n=i[0],a=i[1];return 1===e.values.length?f.P.formatDatePattern(t[0],"day",a):"".concat(f.P.formatDatePattern(t[0],n,a)," / ").concat(f.P.formatDatePattern(t[1],n,a))}return null},T=v(function(){u.vF.logTraceUseMemo("TIME-SLIDER-PANEL - memoLayersList",P);return x.map(function(e){return{layerPath:e,timeSliderLayerInfo:null==P?void 0:P[e]}}).filter(function(e){return(null==e?void 0:e.timeSliderLayerInfo)&&!w(e.layerPath)}).map(function(e){var i,n,r,a;return{layerName:null===(i=c.K.findLayerByPath(b,e.layerPath))||void 0===i?void 0:i.layerName,layerPath:e.layerPath,layerFeatures:k(e.timeSliderLayerInfo),tooltip:(r=e.timeSliderLayerInfo,a=(null===(n=c.K.findLayerByPath(b,e.layerPath))||void 0===n?void 0:n.layerName)||"",(0,m.jsxs)(d.Box,{sx:{display:"flex",alignContent:"center","& svg ":{width:"0.75em",height:"0.75em"}},children:[a,r.filtering&&": ".concat(k(r))]})),layerStatus:"loaded",queryStatus:"processed",layerUniqueId:"".concat(t,"-").concat(p.DF.TIME_SLIDER,"-").concat(e.layerPath)}})},[b,P,x,t,w]);y(function(){u.vF.logTraceUseEffect("TIME-SLIDER-PANEL - memoLayersList",T,L),L&&!T.map(function(e){return e.layerPath}).includes(L)&&j("")},[T,L,j]);return(0,m.jsx)(a.PE,{selectedLayerPath:L,onLayerListClicked:S,layerList:T,guideContentIds:["timeSlider"],children:L&&P&&L in P?(0,m.jsx)(g.p,{config:i,layerPath:L},L):null})}[a,l,o,s,c,d,g]=h.then?(await h)():h,n()}catch(y){n(y)}})},66844:e=>{e.exports=JSON.parse('{"$schema":"http://json-schema.org/draft-07/schema#","title":"GeoView Time Slider Config Schema","type":"object","version":1,"comments":"Configuration for GeoView time slider package.","additionalProperties":false,"properties":{"sliders":{"type":"array","items":{"type":"object","properties":{"title":{"type":"string","default":"Time slider title","description":"The title to display"},"description":{"type":"string","default":"Time slider description","description":"The description to use."},"locked":{"type":"boolean","default":false,"description":"Lock handle"},"reversed":{"type":"boolean","default":false,"description":"Reverse direction of the slider animation"},"defaultValue":{"type":"string","default":false,"description":"Initial value on slider"},"timeDimension":{"additionalProperties":false,"type":"object","description":"OGC time dimension definition.","properties":{"field":{"type":"string"},"default":{"type":"string"},"displayPattern":{"type":"array","items":{"datePrecision":"#/definitions/TypeDatePrecision","timePrecision":"#/definitions/TypeTimePrecision"}},"rangeItems":{"description":"Definition of the range object in the OGC time dimension.","additionalProperties":false,"type":"object","properties":{"type":{"type":"string"},"range":{"type":"array","items":{"type":"string"}}}},"nearestValues":{"enum":["discrete","absolute"]},"singleHandle":{"type":"boolean"},"unitSymbol":{"type":"string"}}}}}}},"required":["sliders"]}')},84609:(e,t,i)=>{i.a(e,async(e,t)=>{try{var n=i(64477),r=i(43549),a=i(51310),l=i(54074),o=i(98615),s=i(75509),c=i(30538),d=i(70501),u=i(67927),p=i(50566),f=i(83085),g=i(63755),m=i(66844),h=i(58938),v=i(97282),y=e([d,u,f,g]);function L(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(L=function(){return!!e})()}function j(e,t,i,n){var r=(0,o.A)((0,l.A)(1&n?e.prototype:e),t,i);return 2&n&&"function"==typeof r?function(e){return r.apply(i,e)}:r}function w(e,t){b(e,t),t.add(e)}function b(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function S(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw new TypeError("Private element is not present on this object")}[d,u,f,g]=y.then?(await y)():y;var x=new WeakSet,P=function(e){function t(){var e,i,r,o;(0,n.A)(this,t);for(var s=arguments.length,c=new Array(s),d=0;d<s;d++)c[d]=arguments[d];return i=this,r=t,o=[].concat(c),r=(0,l.A)(r),w(e=(0,a.A)(i,L()?Reflect.construct(r,o||[],(0,l.A)(i).constructor):r.apply(i,o)),x),e}return(0,s.A)(t,e),(0,r.A)(t,[{key:"schema",value:function(){return m}},{key:"defaultConfig",value:function(){return h}},{key:"defaultTranslations",value:function(){return{en:{timeSlider:{title:"Time Slider",panel:{noLayers:"No layers with temporal data"},slider:{unlockRight:"Unlock right handle",unlockLeft:"Unlock left handle",lockRight:"Lock right handle",lockLeft:"Lock left handle",disableFilter:"Disable Time Filtering",enableFilter:"Enable Time Filtering",pauseAnimation:"Pause animation",playAnimation:"Play animation",back:"Back",forward:"Forward",changeDirection:"Change animation direction",timeDelay:"Animation delay",stepValue:"Step value",hour:"Hour",day:"Day",week:"Week",month:"Month",year:"Year"}}},fr:{timeSlider:{title:"Curseur Temporel",panel:{noLayers:"Pas de couches avec des données temporelles"},slider:{unlockRight:"Déverrouiller la poignée droite",unlockLeft:"Déverrouiller la poignée gauche",lockRight:"Verrouiller la poignée droite",lockLeft:"Verrouiller la poignée gauche",disableFilter:"Désactiver le filtrage temporel",enableFilter:"Activer le filtrage temporel",pauseAnimation:"Pause de l'animation",playAnimation:"Jouer l'animation",back:"Retour",forward:"En avant",changeDirection:"Changer la direction de l'animation",timeDelay:"Délai d'animation",stepValue:"Valeur du saut",hour:"Heure",day:"Jour",week:"Semaine",month:"Mois",year:"Année"}}}}}},{key:"getConfig",value:function(){return j(t,"getConfig",this,3)([])}},{key:"onCreateContentProps",value:function(){return{id:"time-slider",value:this.value,label:"timeSlider.title",icon:(0,v.jsx)(u.TimeSliderIcon,{}),content:(0,v.jsx)(g.b,{mapId:this.mapViewer.mapId,configObj:this.getConfig()})}}},{key:"onAdd",value:function(){var e=this;this.mapViewer.mapLayersLoaded?this.initTimeSliderPlugin():this.mapViewer.onMapLayersLoaded(function(){e.initTimeSliderPlugin()}),j(t,"onAdd",this,3)([])}},{key:"initTimeSliderPlugin",value:function(){var e=this,t=this.mapViewer.layer.getLayerEntryConfigIds(),i=S(x,this,k).call(this,t);i&&i.forEach(function(t){var i=e.mapViewer.layer.getGeoviewLayer(t),n=e.getConfig().sliders.find(function(e){return e.layerPaths.includes(t)});i instanceof d.Z&&f.t.checkInitTimeSliderLayerAndApplyFilters(e.mapViewer.mapId,i,n)})}}])}(p.b);function k(e){var t=this;return e.filter(function(e){var i=t.mapViewer.layer.getGeoviewLayer(e);if(i instanceof d.Z)return i.getTimeDimension()})}c===window.cgpv.reactUtilities.react&&(window.geoviewPlugins=window.geoviewPlugins||{},window.geoviewPlugins["time-slider"]=P),t()}catch(T){t(T)}})}},e=>{var t;t=84609,e(e.s=t)}]);
//# sourceMappingURL=geoview-time-slider.js.map