{"version":3,"file":"corePackages/geoview-custom-legend.js","mappings":"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","sources":["webpack://geoview-core/./src/api/plugin/appbar-plugin.ts","webpack://geoview-core/../geoview-custom-legend/src/custom-legend.tsx","webpack://geoview-core/../geoview-custom-legend/src/custom-legend-style.ts","webpack://geoview-core/../geoview-custom-legend/src/index.tsx"],"sourcesContent":["import { TypeWindow } from '@/core/types/global-types';\nimport { TypeButtonPanel, TypePanelProps } from '@/ui/panel/panel-types';\nimport { IconButtonPropsExtend } from '@/ui/icon-button/icon-button';\nimport { AbstractPlugin } from './abstract-plugin';\n\n/**\n * AppBar Plugin abstract class.\n */\nexport abstract class AppBarPlugin extends AbstractPlugin {\n  // Store the created button panel object\n  buttonPanel?: TypeButtonPanel;\n\n  // Store the button props\n  buttonProps?: IconButtonPropsExtend;\n\n  // Store the panel props\n  panelProps?: TypePanelProps;\n\n  /**\n   * Overrides the get config\n   * @returns {AppBarPluginConfig} The config\n   */\n  override getConfig(): AppBarPluginConfig {\n    return super.getConfig() as AppBarPluginConfig;\n  }\n\n  /**\n   * Overridable function to create app bar button props content\n   * @returns IconButtonPropsExtend The app bar button props content\n   */\n  protected onCreateButtonProps(): IconButtonPropsExtend {\n    // Override this to create the button props..\n\n    // Fetch cgpv\n    const { cgpv } = window as TypeWindow;\n    const { MapIcon } = cgpv.ui.elements;\n\n    // Return dummy plugin button\n    return {\n      id: 'somePluginButton',\n      tooltip: 'Some tooltip',\n      tooltipPlacement: 'right',\n      children: this.reactUtilities.createElement(MapIcon),\n      visible: true,\n    };\n  }\n\n  /**\n   * Overridable function to create app bar props content\n   * @returns TypePanelProps The app bar props content\n   */\n  protected onCreateContentProps(): TypePanelProps {\n    // Override this to create the panel props..\n\n    // Panel props\n    return {\n      title: 'Some title',\n      icon: '<i class=\"material-icons\">map</i>',\n      width: '80vw',\n      status: this.getConfig().isOpen,\n    };\n  }\n\n  /**\n   * Overridable function to create app bar actual content\n   * @returns JSX.Element The app bar actual content\n   */\n  protected onCreateContent(): JSX.Element {\n    // Override this to create panel..\n\n    // Return dummy content\n    return this.reactUtilities.createElement(\n      'div',\n      undefined,\n      `Content for AppBar Plugin on map id ${this.pluginProps.mapId} goes here...`\n    );\n  }\n\n  /**\n   * Called when an app bar plugin is being added\n   */\n  protected onAdd(): void {\n    // Create button props\n    this.buttonProps = this.onCreateButtonProps();\n\n    // Create panel props\n    this.panelProps = this.onCreateContentProps();\n\n    // Create content\n    this.panelProps.content = this.onCreateContent();\n\n    // Create a new button panel on the app-bar\n    this.buttonPanel = this.mapViewer().appBarApi.createAppbarPanel(this.buttonProps, this.panelProps, this.buttonProps.id) || undefined;\n  }\n\n  /**\n   * Called when an app bar plugin is being removed\n   */\n  protected onRemove(): void {\n    // If cgpv exists\n    if (this.buttonPanel) {\n      // Remove the app bar panel\n      this.mapViewer().appBarApi.removeAppbarPanel(this.buttonPanel.buttonPanelId, this.buttonProps!.id!);\n    }\n  }\n}\n\nexport type AppBarPluginConfig = {\n  isOpen: boolean;\n};\n","import { TypeWindow } from 'geoview-core/core/types/global-types';\nimport { getSxClasses } from './custom-legend-style';\n\ninterface CustomLegendPanelProps {\n  config: TypeLegendProps;\n}\n\ninterface LegendItem {\n  legendTitle: string;\n  symbolUrl: string;\n  description?: string;\n}\n\ntype LegendListItems = LegendItem[];\n\nexport type TypeLegendProps = {\n  isOpen: boolean;\n  legendList: LegendListItems;\n  version: string;\n};\n\nexport function CustomLegendPanel(props: CustomLegendPanelProps): JSX.Element {\n  const { config } = props;\n  const { legendList } = config;\n\n  const { cgpv } = window as TypeWindow;\n  const { ui } = cgpv;\n  const { Card, Box } = ui.elements;\n\n  const theme = ui.useTheme();\n  const sxClasses = getSxClasses(theme);\n\n  return (\n    <Box sx={sxClasses.legendCard}>\n      {legendList.map((legendItem: LegendItem, index) => {\n        return (\n          <Card\n            tabIndex={0}\n            className=\"legendCardItem\"\n            // eslint-disable-next-line react/no-array-index-key\n            key={index}\n            title={legendItem.legendTitle}\n            contentCard={\n              // eslint-disable-next-line react/jsx-no-useless-fragment\n              <>\n                {typeof legendItem.symbolUrl === 'string' && (\n                  <div className=\"legend-item-container\">\n                    {/* eslint-disable-next-line react/no-array-index-key */}\n                    <Box component=\"img\" key={index} src={legendItem.symbolUrl} alt=\"\" className=\"legendSymbol\" />\n                    <div className=\"legend-text\">\n                      <span className=\"legend-title\">{legendItem.legendTitle}</span>\n                      {legendItem.description && <span className=\"legend-description\">{legendItem.description}</span>}\n                    </div>\n                  </div>\n                )}\n              </>\n            }\n          />\n        );\n      })}\n    </Box>\n  );\n}\n","// ? I doubt we want to define an explicit type for style properties?\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport const getSxClasses = (theme: any): any => ({\n  legendCard: {\n    display: 'flex',\n    flexDirection: 'column',\n    gap: '8px',\n    padding: '16px',\n    backgroundColor: theme.palette.background.paper,\n    borderRadius: '4px',\n    boxShadow: theme.shadows[1],\n  },\n  legendIcon: {\n    width: '24px',\n    height: '24px',\n    objectFit: 'contain',\n  },\n});\n","import React from 'react'; // GV This import is to validate that we're on the right React at the end of the file\nimport { TypeJsonObject, toJsonObject, AnySchemaObject } from 'geoview-core/api/config/types/config-types';\nimport { AppBarPlugin } from 'geoview-core/api/plugin/appbar-plugin';\nimport { LegendIcon } from 'geoview-core/ui/icons';\nimport { IconButtonPropsExtend } from 'geoview-core/ui/icon-button/icon-button';\nimport { TypePanelProps } from 'geoview-core/ui/panel/panel-types';\nimport { CustomLegendPanel, TypeLegendProps } from './custom-legend';\nimport schema from '../schema.json';\nimport defaultConfig from '../default-config-custom-legend.json';\n\n/**\n * Create a class for the plugin instance\n */\nclass CustomLegendPanelPlugin extends AppBarPlugin {\n  /**\n   * Return the package schema\n   *\n   * @returns {AnySchemaObject} the package schema\n   */\n  override schema(): AnySchemaObject {\n    return schema;\n  }\n\n  /**\n   * Return the default config for this package\n   *\n   * @returns {TypeJsonObject} the default config\n   */\n  override defaultConfig(): TypeJsonObject {\n    return toJsonObject(defaultConfig);\n  }\n\n  /**\n   * Overrides the default translations for the Plugin.\n   * @returns {TypeJsonObject} - The translations object for the particular Plugin.\n   */\n  override defaultTranslations(): TypeJsonObject {\n    return {\n      en: {\n        CustomLegend: {\n          title: 'Custom Legend',\n        },\n      },\n      fr: {\n        CustomLegend: {\n          title: 'Légende personnalisée',\n        },\n      },\n    } as unknown as TypeJsonObject;\n  }\n\n  /**\n   * Overrides the getConfig in order to return the right type.\n   * @returns {TypeLegendProps} The Geochart config\n   */\n  override getConfig(): TypeLegendProps {\n    // Redirect\n    return super.getConfig() as TypeLegendProps;\n  }\n\n  override onCreateButtonProps(): IconButtonPropsExtend {\n    // Button props\n    return {\n      id: `custom-legend`,\n      tooltip: 'CustomLegend.title',\n      tooltipPlacement: 'right',\n      children: <LegendIcon />,\n      visible: true,\n    };\n  }\n\n  override onCreateContentProps(): TypePanelProps {\n    // Panel props\n    return {\n      title: 'CustomLegend.title',\n      icon: <LegendIcon />,\n      width: 350,\n      status: this.getConfig().isOpen,\n    };\n  }\n\n  override onCreateContent = (): JSX.Element => {\n    return <CustomLegendPanel config={this.getConfig()} />;\n  };\n\n  /**\n   * Function called when the plugin is removed, used for clean up\n   */\n  override onRemoved(): void {}\n}\n\nexport default CustomLegendPanelPlugin;\n\n// GV This if condition took over 3 days to investigate. It was giving errors on the app.geo.ca website with\n// GV some conflicting reacts being loaded on the page for some obscure reason.\n// Check if we're on the right react\nif (React === window.cgpv.reactUtilities.react) {\n  // Keep a reference to the Custom Legend Panel Plugin as part of the geoviewPlugins property stored in the window object\n  window.geoviewPlugins = window.geoviewPlugins || {};\n  window.geoviewPlugins['custom-legend'] = CustomLegendPanelPlugin;\n} // Else ignore, don't keep it on the window, wait for the right react load\n"],"names":["AppBarPlugin","_AbstractPlugin","_this","_classCallCheck","_len","arguments","length","args","Array","_key","concat","_defineProperty","_inherits","_createClass","key","value","MapIcon","window","cgpv","ui","elements","id","tooltip","tooltipPlacement","children","this","reactUtilities","createElement","visible","title","icon","width","status","getConfig","isOpen","undefined","pluginProps","mapId","buttonProps","onCreateButtonProps","panelProps","onCreateContentProps","content","onCreateContent","buttonPanel","mapViewer","appBarApi","createAppbarPanel","removeAppbarPanel","buttonPanelId","AbstractPlugin","CustomLegendPanel","props","legendList","config","_ui$elements","Card","Box","sxClasses","theme","legendCard","display","flexDirection","gap","padding","backgroundColor","palette","background","paper","borderRadius","boxShadow","shadows","legendIcon","height","objectFit","getSxClasses","useTheme","_jsx","sx","map","legendItem","index","tabIndex","className","legendTitle","contentCard","_Fragment","symbolUrl","_jsxs","component","src","alt","description","CustomLegendPanelPlugin","_AppBarPlugin","schema","toJsonObject","defaultConfig","en","CustomLegend","fr","LegendIcon","React","react","geoviewPlugins"],"sourceRoot":""}